<!DOCTYPE html>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="datamaps.world.min.js"></script>
   
 
<script>
var csvdata = [];
//https://stackoverflow.com/questions/9491885/csv-to-array-in-d3-js
d3.csv("sucide_data.csv", function(data) {
  data.forEach(function(d) {
    d.year = +d.year;
    d["suicides/100k pop"] = +d["suicides/100k pop"];
    csvdata.push(d);
  });
  console.log(csvdata[0]);
  var rate = Filterdata(csvdata, 2000); 
  console.log(rate);
});

//load csv -> filter through func(year, metric) -> output a json document 
function Filterdata(csvdata, year) {
  var rate_sum = 0;
  var count = 0;
  var arrayLength = csvdata.length;
    for (var i = 0; i < arrayLength; i++) {
        if (year == csvdata[i].year) {
    		rate_sum = rate_sum + csvdata[i]["suicides/100k pop"];
    		count = count + 1;
		}	
    }
  return rate_sum / count;              
}
</script>

</body>
